<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tune multiple machine learning models using cross validation to optimize
performance — tune_models • healthcareai</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Tune multiple machine learning models using cross validation to optimize
performance — tune_models" />
<meta property="og:description" content="Tune multiple machine learning models using cross validation to optimize
performance" />
<meta property="og:image" content="https://docs.healthcare.ai/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-85609357-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-85609357-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">healthcareai</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/site_only/healthcareai.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/site_only/db_connections.html">Database Connections</a>
    </li>
    <li>
      <a href="../articles/site_only/deploy_model.html">Deploying a Model</a>
    </li>
    <li>
      <a href="../articles/site_only/best_levels.html">Variables with Many Categories</a>
    </li>
    <li>
      <a href="../articles/site_only/performance.html">Performance with Big Data</a>
    </li>
    <li>
      <a href="../articles/site_only/transitioning.html">Transition from Version 1</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/HealthCatalyst/healthcareai-r">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://healthcare-ai.slack.com/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tune multiple machine learning models using cross validation to optimize
performance</h1>
    <small class="dont-index">Source: <a href='https://github.com/HealthCatalyst/healthcareai-r/blob/master/R/tune_models.R'><code>R/tune_models.R</code></a></small>
    <div class="hidden name"><code>tune_models.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Tune multiple machine learning models using cross validation to optimize
performance</p>
    </div>

    <pre class="usage"><span class='fu'>tune_models</span>(
  <span class='no'>d</span>,
  <span class='no'>outcome</span>,
  <span class='no'>models</span>,
  <span class='no'>metric</span>,
  <span class='no'>positive_class</span>,
  <span class='kw'>n_folds</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>tune_depth</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>hyperparameters</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>model_class</span>,
  <span class='kw'>model_name</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>allow_parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>A data frame from <code><a href='prep_data.html'>prep_data</a></code>. If you want to prepare
your data on your own, use <code><a href='prep_data.html'>prep_data(..., no_prep = TRUE)</a></code>.</p></td>
    </tr>
    <tr>
      <th>outcome</th>
      <td><p>Optional. Name of the column to predict. When omitted the
outcome from <code><a href='prep_data.html'>prep_data</a></code> is used; otherwise it must match the
outcome provided to <code><a href='prep_data.html'>prep_data</a></code>.</p></td>
    </tr>
    <tr>
      <th>models</th>
      <td><p>Names of models to try. See <code><a href='get_supported_models.html'>get_supported_models</a></code>
for available models. Default is all available models.</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>Which metric should be used to assess model performance?
Options for classification: "ROC" (default) (area under the receiver
operating characteristic curve) or "PR" (area under the precision-recall
curve). Options for regression: "RMSE" (default) (root-mean-squared error,
default), "MAE" (mean-absolute error), or "Rsquared." Options for
multiclass: "Accuracy" (default) or "Kappa" (accuracy, adjusted for class
imbalance).</p></td>
    </tr>
    <tr>
      <th>positive_class</th>
      <td><p>For classification only, which outcome level is the
"yes" case, i.e. should be associated with high probabilities? Defaults to
"Y" or "yes" if present, otherwise is the first level of the outcome
variable (first alphabetically if the training data outcome was not already
a factor).</p></td>
    </tr>
    <tr>
      <th>n_folds</th>
      <td><p>How many folds to use in cross-validation? Default = 5.</p></td>
    </tr>
    <tr>
      <th>tune_depth</th>
      <td><p>How many hyperparameter combinations to try? Default = 10.
Value is multiplied by 5 for regularized regression. Increasing this value
when tuning XGBoost models may be particularly useful for performance.</p></td>
    </tr>
    <tr>
      <th>hyperparameters</th>
      <td><p>Optional, a list of data frames containing
hyperparameter values to tune over. If NULL (default) a random,
<code>tune_depth</code>-deep search of the hyperparameter space will be
performed. If provided, this overrides tune_depth. Should be a named list
of data frames where the names of the list correspond to models (e.g. "rf")
and each column in the data frame contains hyperparameter values. See
<code><a href='get_hyperparameter_defaults.html'>hyperparameters</a></code> for a template. If only one model is
specified to the <code>models</code> argument, the data frame can be provided
bare to this argument.</p></td>
    </tr>
    <tr>
      <th>model_class</th>
      <td><p>"regression" or "classification". If not provided, this
will be determined by the class of `outcome` with the determination
displayed in a message.</p></td>
    </tr>
    <tr>
      <th>model_name</th>
      <td><p>Quoted, name of the model. Defaults to the name of the
outcome variable.</p></td>
    </tr>
    <tr>
      <th>allow_parallel</th>
      <td><p>Depreciated. Instead, control the number of cores though your
parallel back end (e.g. with <code>doMC</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A model_list object. You can call <code>plot</code>, <code>summary</code>,
  <code>evaluate</code>, or <code>predict</code> on a model_list.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that this function is training a lot of models (100 by default)
  and so can take a while to execute. In general a model is trained for each
  hyperparameter combination in each fold for each model, so run time is a
  function of length(models) x n_folds x tune_depth. At the default settings,
  a 1000 row, 10 column data frame should complete in about 30 seconds on a
  good laptop.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>For setting up model training: <code><a href='prep_data.html'>prep_data</a></code>,
  <code><a href='get_supported_models.html'>supported_models</a></code>, <code><a href='get_hyperparameter_defaults.html'>hyperparameters</a></code></p>
<p>For evaluating models: <code><a href='plot.model_list.html'>plot.model_list</a></code>,
  <code><a href='evaluate.html'>evaluate.model_list</a></code></p>
<p>For making predictions: <code><a href='predict.model_list.html'>predict.model_list</a></code></p>
<p>For faster, but not-optimized model training: <code><a href='flash_models.html'>flash_models</a></code></p>
<p>To prepare data and tune models in a single step:
  <code><a href='machine_learn.html'>machine_learn</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>### Examples take about 30 seconds to run</span>
<span class='co'># Prepare data for tuning</span>
<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='prep_data.html'>prep_data</a></span>(<span class='no'>pima_diabetes</span>, <span class='no'>patient_id</span>, <span class='kw'>outcome</span> <span class='kw'>=</span> <span class='no'>diabetes</span>)

<span class='co'># Tune random forest, xgboost, and regularized regression classification models</span>
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'>tune_models</span>(<span class='no'>d</span>)

<span class='co'># Get some info about the tuned models</span>
<span class='no'>m</span>

<span class='co'># Get more detailed info</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>m</span>)

<span class='co'># Plot performance over hyperparameter values for each algorithm</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>m</span>)

<span class='co'># To specify hyperparameter values to tune over, pass a data frame</span>
<span class='co'># of hyperparameter values to the hyperparameters argument:</span>
<span class='no'>rf_hyperparameters</span> <span class='kw'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(
    <span class='kw'>mtry</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>5</span>,
    <span class='kw'>splitrule</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"gini"</span>, <span class='st'>"extratrees"</span>),
    <span class='kw'>min.node.size</span> <span class='kw'>=</span> <span class='fl'>1</span>
  )
<span class='no'>grid_search_models</span> <span class='kw'>&lt;-</span>
  <span class='fu'>tune_models</span>(<span class='kw'>d</span> <span class='kw'>=</span> <span class='no'>d</span>,
              <span class='kw'>outcome</span> <span class='kw'>=</span> <span class='no'>diabetes</span>,
              <span class='kw'>models</span> <span class='kw'>=</span> <span class='st'>"rf"</span>,
              <span class='kw'>hyperparameters</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>rf</span> <span class='kw'>=</span> <span class='no'>rf_hyperparameters</span>)
  )
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>grid_search_models</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Levi Thatcher, Michael Levy, Mike Mastanduno, Taylor Larsen, Taylor Miller, Rex Sumsion.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'ac39465bc37cbef616f5de1e646b6037',
    indexName: 'healthcareai',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


